# roles/dhcpcd/tasks/main
---
- name: install package
  package:
    name: dhcpcd
    state: present
  register: dhcpcd_result
  until: dhcpcd_result is succeeded

- name: install configuration file
  template:
    src: dhcpcd.conf.j2
    dest: /etc/dhcpcd.conf
    owner: root
    group: wheel
    mode: 0444
  notify: restart dhcpcd

- name: enable and start service
  service:
    name: dhcpcd
    enabled: true
    state: started

- name: backup DUID
  fetch:
    src: /var/db/dhcpcd/duid
    dest: backup
    fail_on_missing: true
...
