# roles/nsd/tasks/main
---
- name: install zone files
  template:
    src=zones/{{ item }}.j2 dest=/var/nsd/zones/master/{{ item }}.zone
    owner=root group=wheel mode=0444
    validate='/usr/sbin/nsd-checkzone {{ item }} %s'
  with_items:
    - 32.87.187.81.in-addr.arpa
    - leavethegun.com
    - osborn.io
    - osborn.ws
  notify: reload nsd

- name: install NSD configuration file
  template:
    src=nsd.conf.j2 dest=/var/nsd/etc/nsd.conf
    owner=root group=_nsd mode=0440
    validate='/usr/sbin/nsd-checkconf %s'
  notify: reload nsd

- name: Name Server Daemon (NSD)
  service: name=nsd enabled=yes state=started
...
