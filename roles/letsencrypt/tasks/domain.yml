# roles/letsencrypt/tasks/domain
---
- command: /usr/sbin/acme-client -D {{ domain }}
  args:
    creates: /etc/ssl/{{ domain }}.crt

- fetch:
    dest=backup fail_on_missing=yes src={{ item }}
  with_items:
    - /etc/ssl/{{ domain }}.crt
    - /etc/ssl/{{ domain }}.chain.pem
    - /etc/ssl/{{ domain }}.fullchain.pem
    - /etc/ssl/private/{{ domain }}.key
...
