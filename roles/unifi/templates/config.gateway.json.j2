{
  "protocols": {
    "igmp-proxy": {
      "interface": {
        "{{ hostvars['usg']['lan_if'] }}": {
          "role": "upstream",
          "threshold": "1",
          "alt-subnet": "0.0.0.0/0"
        },
        "{{ hostvars['usg']['iot_if'] }}": {
          "role": "downstream",
          "threshold": "1",
          "alt-subnet": "0.0.0.0/0"
        }
      }
    }
  },
  "service": {
    "dns": {
      "forwarding": {
        "cache-size": "10000",
        "except-interface": [
          "{{ hostvars['usg']['wan_if'] }}"
        ],
        "name-server": [
          "1.1.1.1",
          "1.0.0.1"
        ],
        "options": [
          "domain-needed",
          "host-record=unifi,192.168.1.2",
          "server=/{{ dns_forward_domains | join('/') }}/127.0.0.1#5053",
{% for smartdns_server in smartdns_servers %}
          "server=/{{ smartdns_domains | join('/') }}/{{ smartdns_server }}"{{ ',' if not loop.last }}
{% endfor %}
        ]
      }
    },
    "gui": {
      "older-ciphers": "disable"
    },
    "mdns": {
      "repeater": {
        "interface": [
          "{{ hostvars['usg']['lan_if'] }}",
          "{{ hostvars['usg']['iot_if'] }}"
        ]
      }
    }
  },
  "system": {
    "conntrack": {
      "modules": {
        "ftp": "disable",
        "gre": "disable",
        "h323": "disable",
        "pptp": "disable",
        "sip": "disable"
      }
    },
    "static-host-mapping": {
      "host-name": {
        "trace.svc.ubnt.com": {
          "inet": [
            "0.0.0.0"
          ]
        },
        "warranty.svc.ubnt.com": {
          "inet": [
            "0.0.0.0"
          ]
        }
      }
    }
  }
}
