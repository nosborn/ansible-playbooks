{
  "protocols": {
    "igmp-proxy": {
      "interface": {
        "{{ hostvars['usg']['lan_if'] }}": {
          "role": "upstream",
          "threshold": "1",
          "alt-subnet": "0.0.0.0/0"
        },
        "{{ hostvars['usg']['iot_if'] }}": {
          "role": "downstream",
          "threshold": "1",
          "alt-subnet": "0.0.0.0/0"
        }
      }
    }
  },
  "service": {
    "dns": {
      "forwarding": {
        "cache-size": "10000",
        "except-interface": [
          "{{ hostvars['usg']['wan_if'] }}"
        ],
        "options": [
          "domain-needed",
          "server=1.1.1.1",
          "server=1.0.0.1"
        ]
      }
    },
    "gui": {
      "older-ciphers": "disable"
    },
    "mdns": {
      "repeater": {
        "interface": [
          "{{ hostvars['usg']['lan_if'] }}",
          "{{ hostvars['usg']['iot_if'] }}"
        ]
      }
    },
    "nat": {
      "rule": {
        "1": {
          "description": "Captive DNS",
          "destination": {
            "port": "53"
          },
          "inbound-interface": "{{ hostvars['usg']['lan_if'] }}",
          "inside-address": {
            "address": "{{ lan_dns_ipv4_address }}",
            "port": "53"
          },
          "log": "enable",
          "protocol": "tcp_udp",
          "source": {
            "address": "!{{ lan_dns_ipv4_address }}"
          },
          "type": "destination"
        },
        "5001": {
          "description": "Masquerade for Captive DNS",
          "destination": {
            "address": "{{ lan_dns_ipv4_address }}",
            "port": "53"
          },
          "log": "disable",
          "outbound-interface": "{{ hostvars['usg']['lan_if'] }}",
          "protocol": "tcp_udp",
          "type": "masquerade"
        }
      }
    }
  },
  "system": {
    "conntrack": {
      "modules": {
        "ftp": "disable",
        "gre": "disable",
        "h323": "disable",
        "pptp": "disable",
        "sip": "disable"
      }
    },
    "static-host-mapping": {
      "host-name": {
        "trace.svc.ubnt.com": {
          "inet": [
            "0.0.0.0"
          ]
        },
        "warranty.svc.ubnt.com": {
          "inet": [
            "0.0.0.0"
          ]
        }
      }
    }
  }
}
