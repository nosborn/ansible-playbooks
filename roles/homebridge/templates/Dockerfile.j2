FROM alpine:3.11.2

RUN apk add --no-cache \
		nodejs=12.14.0-r0 \
		npm=12.14.0-r0 \
		tzdata=2019c-r0 \
	&& cp /usr/share/zoneinfo/{{ timezone }} /etc/localtime \
	&& npm set global-style=true \
	&& npm set package-lock=false \
	&& npm install -g --unsafe-perm \
		homebridge@0.4.50 \
		homebridge-bravia \
		homebridge-config-ui-x \
		homebridge-platform-gira-homeserver@0.0.8 \
		homebridge-unifi-occupancy-sensor \
	&& mkdir /homebridge

VOLUME /homebridge

CMD ["/usr/bin/homebridge", "-D", "-I", "-R", "-U", "/homebridge"]
