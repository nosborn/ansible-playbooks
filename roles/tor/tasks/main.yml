# roles/tor/tasks/main
---
- name: install package
  openbsd_pkg: name=tor state=installed
  notify: restart tor

- name: configure onion router
  template:
    src=torrc.j2 dest=/etc/tor/torrc
    owner=root group=wheel mode=0444
    validate='/usr/local/bin/tor -f %s --verify-config --hush'
  notify: restart tor

- name: start service
  service: name=tor arguments='--hush' enabled=yes state=started
...
