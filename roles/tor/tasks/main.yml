---
- name: install package
  community.general.openbsd_pkg:
    name: tor
    state: present

- name: install configuration
  ansible.builtin.template:
    src: torrc.j2
    dest: /etc/tor/torrc
    owner: root
    group: wheel
    mode: 0444
    validate: /usr/local/bin/tor -f %s --verify-config
  notify: restart tor

- name: enable and start service
  ansible.builtin.service:
    name: tor
    enabled: true
    state: started
